
================================================================================
FILE_BEGIN: prisma\schema.prisma
TYPE: PRISMA
SIZE: 6223 bytes
================================================================================
generator client {
  provider = "prisma-client"
  output   = "../src/generated"
}

datasource db {
  provider = "postgresql"
}

model Property {
  id              String   @id @default(uuid())
  address         String
  city            String
  state           String   @default("TX")
  zip             String   @default("")
  lat             Float    @default(0)
  lng             Float    @default(0)
  listPrice       Int      @map("list_price")
  equityGap       Int      @default(0) @map("equity_gap")
  sqft            Int      @default(0)
  bedrooms        Int      @default(0)
  bathrooms       Float    @default(0)
  decision        String   @default("Review")
  strategy        String   @default("None")
  rationale       String   @default("")
  type            String   @default("House for sale")
  realtor         String?
  url             String?
  details         String?
  
  // New fields to match your app logic
  images          String[] @default([])
  estimatedRent   Int      @default(0)
  annualTaxes     Int      @default(0)
  annualInsurance Int      @default(0)
  renovationBudget Int     @default(0)
  afterRepairValue Int     @default(0)
  notes           String   @default("")
  isOwned         Boolean  @default(false) @map("is_owned")
  purchasePrice   Int      @default(0) @map("purchase_price")
  purchaseDate    DateTime? @map("purchase_date")
  rehabCompleted  DateTime? @map("rehab_completed")
  isFavorite      Boolean  @default(false) @map("is_favorite")
  favoriteNotes   String   @default("") @map("favorite_notes")
  dealScore       Float    @default(0) @map("deal_score")
  riskLevel       String   @default("Medium") @map("risk_level")

  createdAt       DateTime @default(now()) @map("created_at")
  updatedAt       DateTime @updatedAt @map("updated_at")

  // Relations
  expenses        Expense[]
  tasks           Task[]
  rehabItems      RehabItem[]
  marketData      MarketData[]
  rentComps       RentComp[]
  projections     Projection[]
  timelineEvents  TimelineEvent[]
  comments        Comment[]
  documents       Document[]

  @@map("properties")
}

model Expense {
  id          String   @id @default(uuid())
  propertyId  String
  property    Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  category    String
  amount      Float
  description String?
  createdAt   DateTime @default(now())

  @@map("expenses")
}

model Task {
  id          String   @id @default(uuid())
  propertyId  String
  property    Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  title       String
  isCompleted Boolean  @default(false)
  createdAt   DateTime @default(now())

  @@map("tasks")
}

model RehabItem {
  id          String   @id @default(uuid())
  propertyId  String
  property    Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  category    String
  item        String
  quantity    Int      @default(1)
  unitCost    Float    @map("unit_cost")
  totalCost   Float    @map("total_cost")
  isCompleted Boolean  @default(false)
  notes       String   @default("")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("rehab_items")
}

model MarketData {
  id            String   @id @default(uuid())
  propertyId    String
  property      Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  neighborhood  String
  avgDaysOnMarket Int    @default(0) @map("avg_days_on_market")
  avgPricePerSqft Float  @default(0) @map("avg_price_per_sqft")
  priceTrend    Float    @default(0) @map("price_trend")
  inventory     Int      @default(0)
  dataDate      DateTime @default(now()) @map("data_date")

  @@map("market_data")
}

model RentComp {
  id          String   @id @default(uuid())
  propertyId  String
  property    Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  address     String
  rentAmount  Int      @map("rent_amount")
  sqft        Int      @default(0)
  bedrooms    Int      @default(0)
  bathrooms   Float    @default(0)
  distance    Float
  source      String   @default("Manual")
  createdAt   DateTime @default(now()) @map("created_at")

  @@map("rent_comps")
}

model Projection {
  id              String   @id @default(uuid())
  propertyId      String
  property        Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  year            Int
  monthlyRent     Float    @map("monthly_rent")
  vacancyRate     Float    @default(0.05) @map("vacancy_rate")
  operatingExpenses Float  @map("operating_expenses")
  mortgagePayment Float    @map("mortgage_payment")
  cashFlow        Float    @map("cash_flow")
  equityBuild     Float    @map("equity_build")
  totalReturn     Float    @map("total_return")
  createdAt       DateTime @default(now()) @map("created_at")

  @@map("projections")
}

model TimelineEvent {
  id          String   @id @default(uuid())
  propertyId  String
  property    Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  title       String
  description String   @default("")
  eventType   String   @map("event_type")
  startDate   DateTime @map("start_date")
  endDate     DateTime? @map("end_date")
  isCompleted Boolean  @default(false)
  assignedTo  String?  @map("assigned_to")
  createdAt   DateTime @default(now()) @map("created_at")

  @@map("timeline_events")
}

model Comment {
  id         String   @id @default(uuid())
  propertyId String
  property   Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  userId     String   @map("user_id")
  userName   String   @map("user_name")
  content    String
  createdAt  DateTime @default(now()) @map("created_at")

  @@map("comments")
}

model Document {
  id          String   @id @default(uuid())
  propertyId  String
  property    Property @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  fileName    String   @map("file_name")
  fileUrl     String   @map("file_url")
  fileType    String   @map("file_type")
  category    String
  uploadedBy  String   @map("uploaded_by")
  createdAt   DateTime @default(now()) @map("created_at")

  @@map("documents")
}


[FILE_END: prisma\schema.prisma]
################################################################################
